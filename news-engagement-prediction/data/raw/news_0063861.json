{"organizations": [], "uuid": "6f73ff7aa50bc5908589dedebc5e311a5b279148", "thread": {"social": {"gplus": {"shares": 8}, "pinterest": {"shares": 0}, "vk": {"shares": 0}, "linkedin": {"shares": 42}, "facebook": {"likes": 136, "shares": 136, "comments": 0}, "stumbledupon": {"shares": 0}}, "site_full": "www.zdnet.com", "main_image": "http://zdnet4.cbsistatic.com/hub/i/r/2016/03/01/35754b40-f56d-4d63-944f-4d018832e0d8/thumbnail/770x578/ad2b2c3e18d1a71fa91a2f09d9f665c0/ssl-thumb.jpg", "site_section": "http://zdnet.com//news/rss.xml", "section_title": "Latest news", "url": "http://www.zdnet.com/article/cloudflare-found-leaking-customer-https-sessions-for-months/", "country": "US", "domain_rank": 1869, "title": "窶気loudflare found leaking customer HTTPS sessions for months", "performance_score": 1, "site": "zdnet.com", "participants_count": 0, "title_full": "窶気loudflare found leaking customer HTTPS sessions for months", "spam_score": 0.0, "site_type": "news", "published": "2017-02-24T07:17:00.000+02:00", "replies_count": 0, "uuid": "6f73ff7aa50bc5908589dedebc5e311a5b279148"}, "author": "", "url": "http://www.zdnet.com/article/cloudflare-found-leaking-customer-https-sessions-for-months/", "ord_in_thread": 0, "title": "窶気loudflare found leaking customer HTTPS sessions for months", "locations": [], "entities": {"persons": [], "locations": [], "organizations": []}, "highlightText": "", "language": "english", "persons": [], "text": "ZDNet Japan 窶気loudflare found leaking customer HTTPS sessions for months Customer information from Uber, 1Password, and online dating site OkCupid is amongst the SSL data leaked by Cloudflare. | Topic: Security \nAlmost a week ago, Google Project Zero security researcher Tavis Ormandy discovered an issue with Cloudflare's edge servers, finding corrupted web pages being returned by some HTTP requests run through Cloudflare. \nCloudflare's edge servers were running past the end of a buffer and returning memory that contained private information such as HTTP cookies, authentication tokens, HTTP POST bodies, and other sensitive data, with some of that data cached by search engines. \n\"I'm finding private messages from major dating sites, full messages from a well-known chat service, online password manager data, frames from adult video sites, hotel bookings. We're talking full HTTPS requests, client IP addresses, full responses, cookies, passwords, keys, data, everything,\" Ormandy wrote . \nThe researcher's theory is that Cloudfare had code in its \"ScrapeShield\" feature that performed something similar to this: int Length = ObfuscateEmailAddressesInHtml(&OutputBuffer, CachedPage);write(fd, OutputBuffer, Length); \n\"But they weren't checking if the obfuscation parsers returned a negative value because of malformed HTML,\" Ormandy added. \n\"My working theory was that this was related to their \"ScrapeShield\" feature which parses and obfuscates HTML -- but because reverse proxies are shared between customers, it would affect *all* Cloudflare customers.\" \nIn response to Ormandy's findings, Cloudflare identified the cause of the problem, and turned off three minor Cloudflare features that were using the same HTML parser chain that was causing the leakage: Email obfuscation, Server-side Excludes, and Automatic HTTPS Rewrites. \nAs a result, it was no longer possible for memory to be returned in an HTTP response. \nAfter fetching a few live samples and observing encryption keys, cookies, passwords, chunks of POST data, and HTTPS requests for other major Cloudflare-hosted sites from other users, Ormandy said he immediately paused his investigation and contacted Cloudflare. \n\"We keep finding more sensitive data that we need to cleanup. I didn't realise how much of the internet was sitting behind a Cloudflare CDN until this incident,\" Ormandy wrote. \nAfter back and forth with Cloudflare regarding its time to disclosure throughout the week, the DNS provider told Ormandy it would be notifying customers by Wednesday of the data leak. However, with notification still not sent by Thursday, and Project Zero's \"7-day\" policy for actively exploited attacks being increasingly pushed, Ormandy made public his findings on Thursday. \n\"Cloudflare has always terminated SSL connections through an isolated instance of NGINX that was not affected by this bug,\" the company wrote in a blog post following Ormandy's public disclosure on Thursday. \n\"We are disclosing this problem now as we are satisfied that search engine caches have now been cleared of sensitive information. We have also not discovered any evidence of malicious exploits of the bug or other reports of its existence.\" \nCloudflare confirmed that customer SSL private keys were not leaked. \nCloudflare also confirmed that the greatest period of impact was during the period of February 13 and February 18, with around one in every 3,300,000 HTTP requests through Cloudflare potentially resulting in memory leakage. More security news", "external_links": [], "published": "2017-02-24T07:17:00.000+02:00", "crawled": "2017-02-24T02:44:55.410+02:00", "highlightTitle": ""}